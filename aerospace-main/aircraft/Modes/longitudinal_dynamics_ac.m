clear
clc
close all

A = [0.000000 0.000000 0.000000 -0.000000 -0.000010 -0.000010 0.998578 0.000000 0.053312 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 
0.000000 0.000000 0.000000 -1.067363 0.000000 20.021224 0.000000 1.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 
0.000000 0.000000 0.000000 -0.000001 -20.021224 0.000000 -0.053312 0.000000 0.998578 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 
0.000000 0.000000 0.000000 -0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 1.000000 0.000000 0.053387 0.000000 0.000000 0.000000 
0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 1.000000 -0.000000 -0.000000 -0.000000 -0.000000 
0.000000 0.000000 0.000000 -0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 1.001424 0.000000 0.000000 0.000000 
0.000000 0.000000 0.000000 0.000000 -9.796049 0.000000 -0.074923 -0.000000 0.675701 0.000000 -1.011240 0.000000 0.000000 0.000000 0.000000 
0.000000 0.000000 0.000000 9.796049 0.000000 0.000000 0.000000 -0.297259 0.000000 1.075660 0.000000 -19.898866 0.000000 0.000000 0.000000 
0.000000 0.000000 0.000000 -0.000005 -0.522991 0.000000 -0.580885 -0.000000 -7.475076 0.000000 18.941525 -0.000000 -0.000000 -0.000000 -0.000000 
0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 -1.370063 0.000000 -17.143958 0.000000 1.067559 0.000000 0.000000 0.000000 
0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.250302 0.000000 -4.688404 0.000000 -4.263354 0.000000 0.000000 0.000000 0.000000 
0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.223819 0.000000 -0.149573 0.000000 -0.543185 0.000000 0.000000 0.000000 
0.000000 0.000000 1.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 
0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 
0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 
];

B = [0.000000 0.000000 0.000000 0.000000 
0.000000 0.000000 0.000000 0.000000 
0.000000 0.000000 0.000000 0.000000 
0.000000 0.000000 0.000000 0.000000 
-0.000000 -0.000000 -0.000000 -0.000000 
0.000000 0.000000 0.000000 0.000000 
0.330078 0.000000 0.000000 1.362908 
0.000000 0.000000 3.131461 0.000000 
-6.182688 -0.000000 -0.000000 -0.000000 
0.000000 -186.191606 6.184559 0.000000 
-86.272928 0.000000 0.000000 0.000000 
0.000000 -8.344168 1.352064 0.000000];

A = A(1:12,1:12); %x,y,z,phi,theta,psi,u,v,w,p,q,r
B = B(1:12,:); %

[v,s] = eig(A);

lon = 1:2:11
lonu = [1 4];

Alon = A(lon,lon);

Blon = B(lon,lonu);

[v,s] = eig(Alon);

sp_states_from_lon = [5 6];

Asp = Alon(sp_states_from_lon,sp_states_from_lon)

Bsp = Blon(sp_states_from_lon,1);

[v,s] = eig(Asp);

%%%For this rc aircraft
rho = 1.225;
S = 0.6558;
cbar = 0.3215;
m = 55.07/9.81;
Iyy = 0.5111;
CD0 = 0.028;
CL0 = 0.062;
CM0 = 0.0598;
CLA = 5.195;
CMQ = -5.263;
CXDT = 7.6509;
u = 19.9928;
w = 1.067;
theta = 0.0533;
CLQ = 4.589;
CMA = -0.9317;
CMDE = -0.8551;
CLDE = 0.2167;
g = 9.81;
alfa = atan2(w,u); %%%This is usually the same

Asp_DRc = [rho*S*u/(2*m)*(CD0-CLA) -rho*S*u*cbar/(4*m)*CLQ+u;
    rho*S*cbar*u/(2*Iyy)*CMA       rho*S*cbar^2*u/(4*Iyy)*CMQ];

Bsp_DRc = [-rho*u^2*S/(2*m)*CLDE*cos(alfa);rho*u^2*S*cbar*CMDE/(2*Iyy)];

Alon_DRc = [0 0 0 1 sin(theta) 0;
    0 0 -u -sin(theta) 1 0;
    0 0 0 0 0 1;
    0 0 -g*cos(theta) -rho*S*u*CD0/m rho*S*u*CL0/(2*m) -w;
    0 0 -g*sin(theta) -rho*S*u*CL0/m rho*S*u*(CD0-CLA)/(2*m) -rho*S*u*cbar/(4*m)*CLQ+u;
    0 0 0 rho*S*cbar*u*CM0/Iyy rho*S*cbar*u*CMA/(2*Iyy) rho*S*cbar^2*u*CMQ/(4*Iyy)]

Blon_DRc = [0 0;
	0 0;
	0 0;
	rho*u^2*S/(2*m)*CLDE*sin(alfa) CXDT/m;
	-rho*u^2*S/(2*m)*CLDE*cos(alfa) 0;
	rho*u^2*S*cbar*CMDE/(2*Iyy) 0];


%ph_states_from_lon = [3 4 5 6];
%ph_states_from_lon = [3 4 5 6];

%Aph = Alon(ph_states_from_lon,ph_states_from_lon)

%[v,s] = eig(Aph)
