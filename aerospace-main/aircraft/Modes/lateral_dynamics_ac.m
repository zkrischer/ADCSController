clear
clc
close all

A = [0.000000 0.000000 0.000000 -0.000000 -0.000010 -0.000010 0.998578 0.000000 0.053312 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 
0.000000 0.000000 0.000000 -1.067363 0.000000 20.021224 0.000000 1.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 
0.000000 0.000000 0.000000 -0.000001 -20.021224 0.000000 -0.053312 0.000000 0.998578 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 
0.000000 0.000000 0.000000 -0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 1.000000 0.000000 0.053387 0.000000 0.000000 0.000000 
0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 1.000000 -0.000000 -0.000000 -0.000000 -0.000000 
0.000000 0.000000 0.000000 -0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 1.001424 0.000000 0.000000 0.000000 
0.000000 0.000000 0.000000 0.000000 -9.796049 0.000000 -0.074923 -0.000000 0.675701 0.000000 -1.011240 0.000000 0.000000 0.000000 0.000000 
0.000000 0.000000 0.000000 9.796049 0.000000 0.000000 0.000000 -0.297259 0.000000 1.075660 0.000000 -19.898866 0.000000 0.000000 0.000000 
0.000000 0.000000 0.000000 -0.000005 -0.522991 0.000000 -0.580885 -0.000000 -7.475076 0.000000 18.941525 -0.000000 -0.000000 -0.000000 -0.000000 
0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 -1.370063 0.000000 -17.143958 0.000000 1.067559 0.000000 0.000000 0.000000 
0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.250302 0.000000 -4.688404 0.000000 -4.263354 0.000000 0.000000 0.000000 0.000000 
0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.223819 0.000000 -0.149573 0.000000 -0.543185 0.000000 0.000000 0.000000 
0.000000 0.000000 1.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 
0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 
0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 
];

B = [0.000000 0.000000 0.000000 0.000000 
0.000000 0.000000 0.000000 0.000000 
0.000000 0.000000 0.000000 0.000000 
0.000000 0.000000 0.000000 0.000000 
-0.000000 -0.000000 -0.000000 -0.000000 
0.000000 0.000000 0.000000 0.000000 
0.330078 0.000000 0.000000 1.362908 
0.000000 0.000000 3.131461 0.000000 
-6.182688 -0.000000 -0.000000 -0.000000 
0.000000 -186.191606 6.184559 0.000000 
-86.272928 0.000000 0.000000 0.000000 
0.000000 -8.344168 1.352064 0.000000];

A = A(1:12,1:12); %x,y,z,phi,theta,psi,u,v,w,p,q,r
B = B(1:12,:); %

[s,v] = eig(A)

%%%For this rc aircraft
rho = 1.225;
S = 0.6558;
b = 2.04;
cbar = 0.3215;
m = 55.07/9.81;
Ixx = 0.4497;
Iyy = 0.5111;
Izz = 0.8470;
CD0 = 0.028;
CL0 = 0.062;
CM0 = 0.0598;

CLA = 5.195;
CNBETA = 0.0116;
CLBETA = -0.0377;
CNR = -0.0276;
CLR = 0.0288;
CMQ = -5.263;
CXDT = 7.6509;
CLP = -0.4625;
CNP = -0.0076;
CLQ = 4.589;
CMA = -0.9317;
CMDE = -0.8551;
CLDE = 0.2167;

u = 19.9928;
w = 1.067;
theta = 0.0533;
g = 9.81;
alfa = atan2(w,u);

%%%%Approximation to Roll Mode
Aroll = 0.25/Ixx * rho * u * S * b * b * CLP;

roll_mode = Aroll;

Q = 0.5*rho*u^2;

Lp = Q*S*b^2/(2*Ixx*u)*CLP;

%%%Approximation to Spiral Mode
Nr = Q*S*b^2/(2*Izz*u)*CNR;
Lr = Q*S*b^2/(2*Ixx*u)*CLR;
Lv = Q*S*b/(Ixx*u)*CLBETA;
Nv = Q*S*b/(Izz*u)*CNBETA;
Np = Q*S*b^2/(Izz*u)*CNP;

spiral_mode = Nr - Lr*Nv/Lv

%%%Approximation to Dutch Roll Mode
%s^2 - ((Lp*Nr+u*Nv-Lr*Np)/(Lp+Nr) + u*(Lv*Np-Lp*Nv)/(Lp+Nr)^2)*s +(u*(Lp*Nv-Lv*Np)/(Lp+Nr))=0

%a*s^2 + b*s + c = 0

a = 1;
b = -((Lp*Nr+u*Nv-Lr*Np)/(Lp+Nr) + u*(Lv*Np-Lp*Nv)/(Lp+Nr)^2);
c = (u*(Lp*Nv-Lv*Np)/(Lp+Nr));
roots([a b c])
